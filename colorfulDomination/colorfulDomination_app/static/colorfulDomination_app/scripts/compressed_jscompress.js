var coloursCD=["#ffffff","#ffff33","#33ff66","#00ccff","#ff66ff","#000000","#cccccc"],fieldColoursCD=["none","#ffff99","#66ff99","#00eeff","#ffaaff"],towersDOMArray=["tower00","tower01","tower02","tower03","tower04","tower05","tower06","tower10","tower11","tower12","tower13","tower14","tower15","tower16","tower20","tower21","tower22","tower23","tower24","tower25","tower26","tower30","tower31","tower32","tower33","tower34","tower35","tower36","tower40","tower41","tower42","tower43","tower44","tower45","tower46","tower50","tower51","tower52","tower53","tower54","tower55","tower56","tower60","tower61","tower62","tower63","tower64","tower65","tower66"],routesDOMArray=["routeH00","routeH01","routeH02","routeH03","routeH04","routeH05","routeH10","routeH11","routeH12","routeH13","routeH14","routeH15","routeH20","routeH21","routeH22","routeH23","routeH24","routeH25","routeH30","routeH31","routeH32","routeH33","routeH34","routeH35","routeH40","routeH41","routeH42","routeH43","routeH44","routeH45","routeH50","routeH51","routeH52","routeH53","routeH54","routeH55","routeH60","routeH61","routeH62","routeH63","routeH64","routeH65","routeV00","routeV01","routeV02","routeV03","routeV04","routeV05","routeV06","routeV10","routeV11","routeV12","routeV13","routeV14","routeV15","routeV16","routeV20","routeV21","routeV22","routeV23","routeV24","routeV25","routeV26","routeV30","routeV31","routeV32","routeV33","routeV34","routeV35","routeV36","routeV40","routeV41","routeV42","routeV43","routeV44","routeV45","routeV46","routeV50","routeV51","routeV52","routeV53","routeV54","routeV55","routeV56"],fieldsDOMArray=["field00","field01","field02","field03","field04","field05","field10","field11","field12","field13","field14","field15","field20","field21","field22","field23","field24","field25","field30","field31","field32","field33","field34","field35","field40","field41","field42","field43","field44","field45","field50","field51","field52","field53","field54","field55"],validMovement=[[0,1,1,0],[0,1,1,1],[0,1,1,1],[0,1,1,1],[0,1,1,1],[0,1,1,1],[0,0,1,1],[1,1,1,0],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,0,1,1],[1,1,1,0],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,0,1,1],[1,1,1,0],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,0,1,1],[1,1,1,0],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,0,1,1],[1,1,1,0],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,0,1,1],[1,1,0,0],[1,1,0,1],[1,1,0,1],[1,1,0,1],[1,1,0,1],[1,1,0,1],[1,0,0,1]],routesFromTowers=[[84,0,42,84],[84,1,43,0],[84,2,44,1],[84,3,45,2],[84,4,46,3],[84,5,47,4],[84,84,48,5],[42,6,49,84],[43,7,50,6],[44,8,51,7],[45,9,52,8],[46,10,53,9],[47,11,54,10],[48,84,55,11],[49,12,56,84],[50,13,57,12],[51,14,58,13],[52,15,59,14],[53,16,60,15],[54,17,61,16],[55,84,62,17],[56,18,63,84],[57,19,64,18],[58,20,65,19],[59,21,66,20],[60,22,67,21],[61,23,68,22],[62,84,69,23],[63,24,70,84],[64,25,71,24],[65,26,72,25],[66,27,73,26],[67,28,74,27],[68,29,75,28],[69,84,76,29],[70,30,77,84],[71,31,78,30],[72,32,79,31],[73,33,80,32],[74,34,81,33],[75,35,82,34],[76,84,83,35],[77,36,84,84],[78,37,84,36],[79,38,84,37],[80,39,84,38],[81,40,84,39],[82,41,84,40],[83,84,84,41]],routeOwners,towerOwners,init,randomCDColor,initGame,keyDown,actionValidatorArrows,movementCommand,selectCommand,deselectCommand,expandRoute,routeIndex,constructTower,forwardGame,forwardConstruction,whichFieldsToCheck,fieldAquiredCheck,updateTimer,gameOver,isGameOn,gameTime,timerTick,playerColour,movementHighlight,routesBuildArray,towersBuildArray,currentPosition,isCurrentPositionSelected,isBtnSelectFirstPress;randomCDColor=function(){return Math.floor(4*Math.random())+1},init=function(){var a=randomCDColor(),b=a%4+1,c=(a+1)%4+1,d=(a+2)%4+1,e=document.getElementById("playerNameBorder");e.style.fill=coloursCD[a];var f=document.getElementById("btnPlay");f.onclick=function(){var a=document.getElementById("inGame");a.style.display="inline",a=document.getElementById("territoryFields"),a.style.display="inline",a=document.getElementById("routes"),a.style.display="inline",a=document.getElementById("basesAndTowers"),a.style.display="inline",initGame()},f.onmouseover=function(){var a=document.getElementById("btnPlayCircle");a.style.fill=coloursCD[b]},f.onmouseout=function(){var a=document.getElementById("btnPlayCircle");a.style.fill="none"};var g=document.getElementById("btnStats");g.onclick=function(){},g.onmouseover=function(){var a=document.getElementById("btnStatsCircle");a.style.fill=coloursCD[c]},g.onmouseout=function(){var a=document.getElementById("btnStatsCircle");a.style.fill="none"};var h=document.getElementById("btnExit");h.onmouseover=function(){var a=document.getElementById("btnExitCircle");a.style.fill=coloursCD[d]},h.onmouseout=function(){var a=document.getElementById("btnExitCircle");a.style.fill="none"};var i,j,k;"classList"in document.documentElement?(i=function(a,b){return a.classList.contains(b)},j=function(a,b){a.classList.add(b)},k=function(a,b){a.classList.remove(b)}):(i=function(a,b){return new RegExp("\\b"+b+"\\b").test(a.className)},j=function(a,b){i(a,b)||(a.className+=" "+b)},k=function(a,b){a.className=a.className.replace(new RegExp("\\b"+b+"\\b","g"),"")});for(var l=0;l<84;l++)initDOMElements=document.getElementById(routesDOMArray[l]),i(initDOMElements,"route")||j(initDOMElements,"route"),l<49&&(initDOMElements=document.getElementById(towersDOMArray[l]),i(initDOMElements,"tower")||j(initDOMElements,"tower"));isGameOn=!1},initGame=function(){playerColour=randomCDColor();var a;a=document.getElementById("playerNameBorderInGame"),a.style.fill=coloursCD[playerColour],isCurrentPositionSelected=!1,isBtnSelectFirstPress=!0,keyboard={},gameTime=120,updateTimer(),routeOwners=new Array(84),towerOwners=new Array(49),routesBuildArray=new Array(84),towersBuildArray=new Array(49);for(var b=0;b<84;b++)routeOwners[b]=0,routesBuildArray[b]=0,b<49&&(towerOwners[b]=0,towersBuildArray[b]=0);coloursCD[playerColour]===coloursCD[1]?(currentPosition=0,a=document.getElementById(towersDOMArray[currentPosition])):coloursCD[playerColour]===coloursCD[2]?(currentPosition=42,a=document.getElementById(towersDOMArray[currentPosition])):coloursCD[playerColour]===coloursCD[3]?(currentPosition=6,a=document.getElementById(towersDOMArray[currentPosition])):coloursCD[playerColour]===coloursCD[4]&&(currentPosition=48,a=document.getElementById(towersDOMArray[currentPosition])),a.style.stroke=coloursCD[playerColour],towerOwners[currentPosition]=playerColour,a=document.getElementById("btnUpArrow"),a.addEventListener("click",function(){isGameOn&&actionValidatorArrows(0)}),a=document.getElementById("btnRightArrow"),a.addEventListener("click",function(){isGameOn&&actionValidatorArrows(1)}),a=document.getElementById("btnDownArrow"),a.addEventListener("click",function(){isGameOn&&actionValidatorArrows(2)}),a=document.getElementById("btnLeftArrow"),a.addEventListener("click",function(){isGameOn&&actionValidatorArrows(3)}),a=document.getElementById("btnSelect"),a.addEventListener("click",function(){isGameOn&&selectCommand()}),timerTick=setInterval(function(){forwardGame(),0===gameTime&&gameOver()},1e3),isGameOn=!0},actionValidatorArrows=function(a){0!==validMovement[currentPosition][a]&&(routeOwners[routesFromTowers[currentPosition][a]]!==playerColour||isCurrentPositionSelected?routeOwners[routesFromTowers[currentPosition][a]]!==playerColour&&isCurrentPositionSelected&&expandRoute(a):movementCommand(a))},movementCommand=function(a){switch(movementHighlight=document.getElementById(towersDOMArray[currentPosition]),movementHighlight.style.stroke="#000000",a){case 0:currentPosition-=7;break;case 1:currentPosition++;break;case 2:currentPosition+=7;break;case 3:currentPosition--}movementHighlight=document.getElementById(towersDOMArray[currentPosition]),movementHighlight.style.stroke=coloursCD[playerColour]},selectCommand=function(){var a=document.getElementById("btnSelectCircle");isBtnSelectFirstPress?towerOwners[currentPosition]===playerColour?(isCurrentPositionSelected=!0,isBtnSelectFirstPress=!1,a.style.fill=coloursCD[playerColour]):constructTower():deselectCommand()},deselectCommand=function(){isCurrentPositionSelected=!1,isBtnSelectFirstPress=!0,btnSelectCircle.style.fill=coloursCD[0]},expandRoute=function(a){if(routeIndex=routesFromTowers[currentPosition][a],0==routesBuildArray[routeIndex]){var b=document.getElementById(routesDOMArray[routeIndex]);routesBuildArray[routeIndex]=6,0==routeOwners[routeIndex]?(b.style["stroke-width"]="5px",b.style.stroke=coloursCD[playerColour]):(b.style["stroke-width"]="1px",b.style.stroke=coloursCD[5])}deselectCommand()},constructTower=function(){if(0==towersBuildArray[currentPosition]){var a=document.getElementById(towersDOMArray[currentPosition]);towersBuildArray[currentPosition]=6,0==towerOwners[currentPosition]?a.style.fill=coloursCD[playerColour]:a.style.stroke=coloursCD[6]}},forwardGame=function(){gameTime--,updateTimer(),forwardConstruction(routesBuildArray,!0),forwardConstruction(towersBuildArray,!1)},forwardConstruction=function(a,b){for(var c=0;c<a.length;c++)if(1==a[c]){if(b)routeOwners[c]=playerColour,c<42?0===parseInt(c/6)?fieldAquiredCheck(!1,!1,!1,!0,c+c%6+1):5===parseInt(c/6)?fieldAquiredCheck(!0,!1,!1,!1,c+c%6+1):fieldAquiredCheck(!0,!1,!1,!0,c+c%6+1):c%7===0?fieldAquiredCheck(!1,!0,!1,!1,c-42):c%7===6?fieldAquiredCheck(!0,!1,!1,!1,c-42):fieldAquiredCheck(!0,!0,!1,!1,c-42);else{var d=parseInt(c/7),e=c%7;towerOwners[c]=playerColour,0===d&&0===e?fieldAquiredCheck(!0,!1,!1,!1,c):0===d&&e>0&&e<6?fieldAquiredCheck(!0,!0,!1,!1,c):0===d&&6===e?fieldAquiredCheck(!1,!0,!1,!1,c):d>0&&d<6&&6===e?fieldAquiredCheck(!1,!0,!0,!1,c):6===d&&6===e?fieldAquiredCheck(!1,!1,!0,!1,c):6===d&&e>0&&e<6?fieldAquiredCheck(!1,!1,!0,!0,c):6===d&&0===e?fieldAquiredCheck(!1,!1,!1,!0,c):d>0&&d<6&&0===e?fieldAquiredCheck(!0,!1,!1,!0,c):fieldAquiredCheck(!0,!0,!0,!0,c)}a[c]=0}else 0!=a[c]&&a[c]--},whichFieldsToCheck=function(a,b){},fieldAquiredCheck=function(a,b,c,d,e){var f=parseInt(e/7),g=e%7;if(a&&towerOwners[e]==playerColour&&towerOwners[e-1]==playerColour&&towerOwners[e-7]==playerColour&&towerOwners[e-7-1]==playerColour&&routeOwners[e-(f+1)]==playerColour&&routeOwners[e-(f+1)-6]==playerColour&&routeOwners[42+7*(f-1)+g]==playerColour&&routeOwners[42+7*(f-1)+g-1]==playerColour){console.log("Field occupied: NW "+fieldsDOMArray[6*(f-1)+g-1]);var h=document.getElementById(fieldsDOMArray[6*(f-1)+g-1]);h.style.fill=fieldColoursCD[playerColour]}if(b&&towerOwners[e]==playerColour&&towerOwners[e+1]==playerColour&&towerOwners[e-7]==playerColour&&towerOwners[e-7+1]==playerColour&&routeOwners[e-f]==playerColour&&routeOwners[e-f-6]==playerColour&&routeOwners[42+7*(f-1)+g]==playerColour&&routeOwners[42+7*(f-1)+g+1]==playerColour){console.log("Field occupied: NE "+fieldsDOMArray[6*(f-1)+g]);var h=document.getElementById(fieldsDOMArray[6*(f-1)+g]);h.style.fill=fieldColoursCD[playerColour]}if(c&&towerOwners[e]==playerColour&&towerOwners[e+1]==playerColour&&towerOwners[e+7]==playerColour&&towerOwners[e+7+1]==playerColour&&routeOwners[e-f]==playerColour&&routeOwners[e-f+6]==playerColour&&routeOwners[42+7*f+g]==playerColour&&routeOwners[42+7*f+g+1]==playerColour){console.log("Field occupied: SE "+fieldsDOMArray[6*f+g]);var h=document.getElementById(fieldsDOMArray[6*f+g]);h.style.fill=fieldColoursCD[playerColour]}if(d&&towerOwners[e]==playerColour&&towerOwners[e-1]==playerColour&&towerOwners[e+7]==playerColour&&towerOwners[e+7-1]==playerColour&&routeOwners[e-(f+1)]==playerColour&&routeOwners[e-(f+1)+6]==playerColour&&routeOwners[42+7*f+g]==playerColour&&routeOwners[42+7*f+g-1]==playerColour){console.log("Field occupied: SW "+fieldsDOMArray[6*f+g-1]);var h=document.getElementById(fieldsDOMArray[6*f+g-1]);h.style.fill=fieldColoursCD[playerColour]}},updateTimer=function(){var a=document.getElementById("txtContentTimer"),b="",c=String(parseInt(gameTime/60)),d=String(gameTime%60);b+=c<10?"0"+c:c,b+=":",b+=d<10?"0"+d:d,a.innerHTML=b},gameOver=function(){isGameOn=!1,clearInterval(timerTick);var a=document.getElementById("inGame");a.style.display="none",a=document.getElementById("territoryFields"),a.style.display="none",a=document.getElementById("routes"),a.style.display="none",a=document.getElementById("basesAndTowers"),a.style.display="none";for(var b=0;b<84;b++)a=document.getElementById(routesDOMArray[b]),a.style["stroke-width"]="1px",a.style.stroke=coloursCD[5],b<49&&(a=document.getElementById(towersDOMArray[b]),a.style.fill=coloursCD[6],a.style.stroke=coloursCD[5]),b<36&&(a=document.getElementById(fieldsDOMArray[b]),a.style.fill=fieldColoursCD[0]),0===b&&(a.style.fill=coloursCD[1]),6===b&&(a.style.fill=coloursCD[3]),42===b&&(a.style.fill=coloursCD[2]),48===b&&(a.style.fill=coloursCD[4])},keyDown=function(a){isGameOn&&(37==a.keyCode&&actionValidatorArrows(3),39==a.keyCode&&actionValidatorArrows(1),38==a.keyCode&&actionValidatorArrows(0),40==a.keyCode&&actionValidatorArrows(2),32==a.keyCode&&selectCommand())},document.addEventListener("keydown",keyDown);